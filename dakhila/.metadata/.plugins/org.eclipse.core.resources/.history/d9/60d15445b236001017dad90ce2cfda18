<?php
$libDir="/var/www/dakhila/libVidyalaya/";
require_once "$libDir/db.inc";
require_once "$libDir/vidyalaya.inc";



function cityAllocation($students) {

	$tata = array();
	$town = array();

	foreach ($students as $id => $student) {
		if ($student->IsEnrolled) {
			$zip = $student->family->address->zipcode;
			$city = $student->family->address->city;
			if (array_key_exists($zip, $tata)) {
				$tata[$zip]++;
			} else {
				$tata[$zip]=1;
				$town[$zip] = $city;
			}
		}


	}
	ksort($tata);
	foreach ($tata as $zip => $number) {
		printf( "%2d, %s, %s\n", $number,  $zip, $town[$zip] );
	}
}

function cultureAge($students) {
		foreach ($students as $id => $student) {
		if ($student->IsEnrolled) {
			$dateOfBirth=strtotime($student->dateOfBirth);
			$age = (time() - $dateOfBirth)/60/60/24/365;
			printf ("%s, %s, %s, %d, %s, %s\n", 
			$student->lastName, $student->firstName, $student->registration->culture->description, $age, time(), $dateOfBirth);
		}
	}
}

$students = GetAllData();

//cityAllocation($students);
cultureAge($students);


?>